#include <stddef.h>
#include "event/clear_oam.h"
#include "event/clear_vertical_blank.h"
#include "event/evaluate_sprite.h"
#include "event/increment_vram_x.h"
#include "event/increment_vram_y.h"
#include "event/load_palette_id.h"
#include "event/load_shifters.h"
#include "event/load_sprite.h"
#include "event/load_tile_high.h"
#include "event/load_tile_id.h"
#include "event/load_tile_low.h"
#include "event/load_vram_x.h"
#include "event/load_vram_y.h"
#include "event/render_pixel.h"
#include "event/set_vertical_blank.h"
#include "event/skip_cycle.h"
#include "event/sprite_zero_hit.h"
#include "event/update_sprite_shifters.h"
#include "event/update_tile_shifters.h"
#include "event.h"

enum { max_events = 20 };

enum event {
	ID = 0,
	SH = 1 << 0,
	RP = 1 << 1,
	LT = 1 << 2,
	LP = 1 << 3,
	LH = 1 << 4,
	LL = 1 << 5,
	LS = 1 << 6,
	BS = 1 << 7,
	LX = 1 << 8,
	LY = 1 << 9,
	IX = 1 << 10,
	IY = 1 << 11,
	CV = 1 << 12,
	SV = 1 << 13,
	CO = 1 << 14,
	FS = 1 << 15,
	ES = 1 << 16,
	SS = 1 << 17,
	SC = 1 << 18,
};

static void (*event_map[max_events])(struct ppu *ppu) = {
	NULL,
	&sprite_zero_hit,
	&render_pixel,
	&load_tile_id,
	&load_palette_id,
	&load_tile_high,
	&load_tile_low,
	&load_shifters,
	&update_tile_shifters,
	&load_vram_x,
	&load_vram_y,
	&increment_vram_x,
	&increment_vram_y,
	&clear_vertical_blank,
	&set_vertical_blank,
	&clear_oam,
	&update_sprite_shifters,
	&evaluate_sprite,
	&load_sprite,
	&skip_cycle,
};

static enum event visible_scanline[341] = {
/* 000 */ ID,
/* 001 */ RP|LS|LT|BS|FS|CO,
/* 002 */ RP|SH|BS|FS|CO,
/* 003 */ RP|SH|LP|BS|FS|CO,
/* 004 */ RP|SH|BS|FS|CO,
/* 005 */ RP|SH|LL|BS|FS|CO,
/* 006 */ RP|SH|BS|FS|CO,
/* 007 */ RP|SH|LH|BS|FS|CO,
/* 008 */ RP|SH|IX|BS|FS|CO,
/* 009 */ RP|SH|LS|LT|BS|FS|CO,
/* 010 */ RP|SH|BS|FS|CO,
/* 011 */ RP|SH|LP|BS|FS|CO,
/* 012 */ RP|SH|BS|FS|CO,
/* 013 */ RP|SH|LL|BS|FS|CO,
/* 014 */ RP|SH|BS|FS|CO,
/* 015 */ RP|SH|LH|BS|FS|CO,
/* 016 */ RP|SH|IX|BS|FS|CO,
/* 017 */ RP|SH|LS|LT|BS|FS|CO,
/* 018 */ RP|SH|BS|FS|CO,
/* 019 */ RP|SH|LP|BS|FS|CO,
/* 020 */ RP|SH|BS|FS|CO,
/* 021 */ RP|SH|LL|BS|FS|CO,
/* 022 */ RP|SH|BS|FS|CO,
/* 023 */ RP|SH|LH|BS|FS|CO,
/* 024 */ RP|SH|IX|BS|FS|CO,
/* 025 */ RP|SH|LS|LT|BS|FS|CO,
/* 026 */ RP|SH|BS|FS|CO,
/* 027 */ RP|SH|LP|BS|FS|CO,
/* 028 */ RP|SH|BS|FS|CO,
/* 029 */ RP|SH|LL|BS|FS|CO,
/* 030 */ RP|SH|BS|FS|CO,
/* 031 */ RP|SH|LH|BS|FS|CO,
/* 032 */ RP|SH|IX|BS|FS|CO,
/* 033 */ RP|SH|LS|LT|BS|FS|CO,
/* 034 */ RP|SH|BS|FS|CO,
/* 035 */ RP|SH|LP|BS|FS|CO,
/* 036 */ RP|SH|BS|FS|CO,
/* 037 */ RP|SH|LL|BS|FS|CO,
/* 038 */ RP|SH|BS|FS|CO,
/* 039 */ RP|SH|LH|BS|FS|CO,
/* 040 */ RP|SH|IX|BS|FS|CO,
/* 041 */ RP|SH|LS|LT|BS|FS|CO,
/* 042 */ RP|SH|BS|FS|CO,
/* 043 */ RP|SH|LP|BS|FS|CO,
/* 044 */ RP|SH|BS|FS|CO,
/* 045 */ RP|SH|LL|BS|FS|CO,
/* 046 */ RP|SH|BS|FS|CO,
/* 047 */ RP|SH|LH|BS|FS|CO,
/* 048 */ RP|SH|IX|BS|FS|CO,
/* 049 */ RP|SH|LS|LT|BS|FS|CO,
/* 050 */ RP|SH|BS|FS|CO,
/* 051 */ RP|SH|LP|BS|FS|CO,
/* 052 */ RP|SH|BS|FS|CO,
/* 053 */ RP|SH|LL|BS|FS|CO,
/* 054 */ RP|SH|BS|FS|CO,
/* 055 */ RP|SH|LH|BS|FS|CO,
/* 056 */ RP|SH|IX|BS|FS|CO,
/* 057 */ RP|SH|LS|LT|BS|FS|CO,
/* 058 */ RP|SH|BS|FS|CO,
/* 059 */ RP|SH|LP|BS|FS|CO,
/* 060 */ RP|SH|BS|FS|CO,
/* 061 */ RP|SH|LL|BS|FS|CO,
/* 062 */ RP|SH|BS|FS|CO,
/* 063 */ RP|SH|LH|BS|FS|CO,
/* 064 */ RP|SH|IX|BS|FS|CO,
/* 065 */ RP|SH|LS|LT|BS|FS|ES,
/* 066 */ RP|SH|BS|FS|ES,
/* 067 */ RP|SH|LP|BS|FS|ES,
/* 068 */ RP|SH|BS|FS|ES,
/* 069 */ RP|SH|LL|BS|FS|ES,
/* 070 */ RP|SH|BS|FS|ES,
/* 071 */ RP|SH|LH|BS|FS|ES,
/* 072 */ RP|SH|IX|BS|FS|ES,
/* 073 */ RP|SH|LS|LT|BS|FS|ES,
/* 074 */ RP|SH|BS|FS|ES,
/* 075 */ RP|SH|LP|BS|FS|ES,
/* 076 */ RP|SH|BS|FS|ES,
/* 077 */ RP|SH|LL|BS|FS|ES,
/* 078 */ RP|SH|BS|FS|ES,
/* 079 */ RP|SH|LH|BS|FS|ES,
/* 080 */ RP|SH|IX|BS|FS|ES,
/* 081 */ RP|SH|LS|LT|BS|FS|ES,
/* 082 */ RP|SH|BS|FS|ES,
/* 083 */ RP|SH|LP|BS|FS|ES,
/* 084 */ RP|SH|BS|FS|ES,
/* 085 */ RP|SH|LL|BS|FS|ES,
/* 086 */ RP|SH|BS|FS|ES,
/* 087 */ RP|SH|LH|BS|FS|ES,
/* 088 */ RP|SH|IX|BS|FS|ES,
/* 089 */ RP|SH|LS|LT|BS|FS|ES,
/* 090 */ RP|SH|BS|FS|ES,
/* 091 */ RP|SH|LP|BS|FS|ES,
/* 092 */ RP|SH|BS|FS|ES,
/* 093 */ RP|SH|LL|BS|FS|ES,
/* 094 */ RP|SH|BS|FS|ES,
/* 095 */ RP|SH|LH|BS|FS|ES,
/* 096 */ RP|SH|IX|BS|FS|ES,
/* 097 */ RP|SH|LS|LT|BS|FS|ES,
/* 098 */ RP|SH|BS|FS|ES,
/* 099 */ RP|SH|LP|BS|FS|ES,
/* 100 */ RP|SH|BS|FS|ES,
/* 101 */ RP|SH|LL|BS|FS|ES,
/* 102 */ RP|SH|BS|FS|ES,
/* 103 */ RP|SH|LH|BS|FS|ES,
/* 104 */ RP|SH|IX|BS|FS|ES,
/* 105 */ RP|SH|LS|LT|BS|FS|ES,
/* 106 */ RP|SH|BS|FS|ES,
/* 107 */ RP|SH|LP|BS|FS|ES,
/* 108 */ RP|SH|BS|FS|ES,
/* 109 */ RP|SH|LL|BS|FS|ES,
/* 110 */ RP|SH|BS|FS|ES,
/* 111 */ RP|SH|LH|BS|FS|ES,
/* 112 */ RP|SH|IX|BS|FS|ES,
/* 113 */ RP|SH|LS|LT|BS|FS|ES,
/* 114 */ RP|SH|BS|FS|ES,
/* 115 */ RP|SH|LP|BS|FS|ES,
/* 116 */ RP|SH|BS|FS|ES,
/* 117 */ RP|SH|LL|BS|FS|ES,
/* 118 */ RP|SH|BS|FS|ES,
/* 119 */ RP|SH|LH|BS|FS|ES,
/* 120 */ RP|SH|IX|BS|FS|ES,
/* 121 */ RP|SH|LS|LT|BS|FS|ES,
/* 122 */ RP|SH|BS|FS|ES,
/* 123 */ RP|SH|LP|BS|FS|ES,
/* 124 */ RP|SH|BS|FS|ES,
/* 125 */ RP|SH|LL|BS|FS|ES,
/* 126 */ RP|SH|BS|FS|ES,
/* 127 */ RP|SH|LH|BS|FS|ES,
/* 128 */ RP|SH|IX|BS|FS|ES,
/* 129 */ RP|SH|LS|LT|BS|FS|ES,
/* 130 */ RP|SH|BS|FS|ES,
/* 131 */ RP|SH|LP|BS|FS|ES,
/* 132 */ RP|SH|BS|FS|ES,
/* 133 */ RP|SH|LL|BS|FS|ES,
/* 134 */ RP|SH|BS|FS|ES,
/* 135 */ RP|SH|LH|BS|FS|ES,
/* 136 */ RP|SH|IX|BS|FS|ES,
/* 137 */ RP|SH|LS|LT|BS|FS|ES,
/* 138 */ RP|SH|BS|FS|ES,
/* 139 */ RP|SH|LP|BS|FS|ES,
/* 140 */ RP|SH|BS|FS|ES,
/* 141 */ RP|SH|LL|BS|FS|ES,
/* 142 */ RP|SH|BS|FS|ES,
/* 143 */ RP|SH|LH|BS|FS|ES,
/* 144 */ RP|SH|IX|BS|FS|ES,
/* 145 */ RP|SH|LS|LT|BS|FS|ES,
/* 146 */ RP|SH|BS|FS|ES,
/* 147 */ RP|SH|LP|BS|FS|ES,
/* 148 */ RP|SH|BS|FS|ES,
/* 149 */ RP|SH|LL|BS|FS|ES,
/* 150 */ RP|SH|BS|FS|ES,
/* 151 */ RP|SH|LH|BS|FS|ES,
/* 152 */ RP|SH|IX|BS|FS|ES,
/* 153 */ RP|SH|LS|LT|BS|FS|ES,
/* 154 */ RP|SH|BS|FS|ES,
/* 155 */ RP|SH|LP|BS|FS|ES,
/* 156 */ RP|SH|BS|FS|ES,
/* 157 */ RP|SH|LL|BS|FS|ES,
/* 158 */ RP|SH|BS|FS|ES,
/* 159 */ RP|SH|LH|BS|FS|ES,
/* 160 */ RP|SH|IX|BS|FS|ES,
/* 161 */ RP|SH|LS|LT|BS|FS|ES,
/* 162 */ RP|SH|BS|FS|ES,
/* 163 */ RP|SH|LP|BS|FS|ES,
/* 164 */ RP|SH|BS|FS|ES,
/* 165 */ RP|SH|LL|BS|FS|ES,
/* 166 */ RP|SH|BS|FS|ES,
/* 167 */ RP|SH|LH|BS|FS|ES,
/* 168 */ RP|SH|IX|BS|FS|ES,
/* 169 */ RP|SH|LS|LT|BS|FS|ES,
/* 170 */ RP|SH|BS|FS|ES,
/* 171 */ RP|SH|LP|BS|FS|ES,
/* 172 */ RP|SH|BS|FS|ES,
/* 173 */ RP|SH|LL|BS|FS|ES,
/* 174 */ RP|SH|BS|FS|ES,
/* 175 */ RP|SH|LH|BS|FS|ES,
/* 176 */ RP|SH|IX|BS|FS|ES,
/* 177 */ RP|SH|LS|LT|BS|FS|ES,
/* 178 */ RP|SH|BS|FS|ES,
/* 179 */ RP|SH|LP|BS|FS|ES,
/* 180 */ RP|SH|BS|FS|ES,
/* 181 */ RP|SH|LL|BS|FS|ES,
/* 182 */ RP|SH|BS|FS|ES,
/* 183 */ RP|SH|LH|BS|FS|ES,
/* 184 */ RP|SH|IX|BS|FS|ES,
/* 185 */ RP|SH|LS|LT|BS|FS|ES,
/* 186 */ RP|SH|BS|FS|ES,
/* 187 */ RP|SH|LP|BS|FS|ES,
/* 188 */ RP|SH|BS|FS|ES,
/* 189 */ RP|SH|LL|BS|FS|ES,
/* 190 */ RP|SH|BS|FS|ES,
/* 191 */ RP|SH|LH|BS|FS|ES,
/* 192 */ RP|SH|IX|BS|FS|ES,
/* 193 */ RP|SH|LS|LT|BS|FS|ES,
/* 194 */ RP|SH|BS|FS|ES,
/* 195 */ RP|SH|LP|BS|FS|ES,
/* 196 */ RP|SH|BS|FS|ES,
/* 197 */ RP|SH|LL|BS|FS|ES,
/* 198 */ RP|SH|BS|FS|ES,
/* 199 */ RP|SH|LH|BS|FS|ES,
/* 200 */ RP|SH|IX|BS|FS|ES,
/* 201 */ RP|SH|LS|LT|BS|FS|ES,
/* 202 */ RP|SH|BS|FS|ES,
/* 203 */ RP|SH|LP|BS|FS|ES,
/* 204 */ RP|SH|BS|FS|ES,
/* 205 */ RP|SH|LL|BS|FS|ES,
/* 206 */ RP|SH|BS|FS|ES,
/* 207 */ RP|SH|LH|BS|FS|ES,
/* 208 */ RP|SH|IX|BS|FS|ES,
/* 209 */ RP|SH|LS|LT|BS|FS|ES,
/* 210 */ RP|SH|BS|FS|ES,
/* 211 */ RP|SH|LP|BS|FS|ES,
/* 212 */ RP|SH|BS|FS|ES,
/* 213 */ RP|SH|LL|BS|FS|ES,
/* 214 */ RP|SH|BS|FS|ES,
/* 215 */ RP|SH|LH|BS|FS|ES,
/* 216 */ RP|SH|IX|BS|FS|ES,
/* 217 */ RP|SH|LS|LT|BS|FS|ES,
/* 218 */ RP|SH|BS|FS|ES,
/* 219 */ RP|SH|LP|BS|FS|ES,
/* 220 */ RP|SH|BS|FS|ES,
/* 221 */ RP|SH|LL|BS|FS|ES,
/* 222 */ RP|SH|BS|FS|ES,
/* 223 */ RP|SH|LH|BS|FS|ES,
/* 224 */ RP|SH|IX|BS|FS|ES,
/* 225 */ RP|SH|LS|LT|BS|FS|ES,
/* 226 */ RP|SH|BS|FS|ES,
/* 227 */ RP|SH|LP|BS|FS|ES,
/* 228 */ RP|SH|BS|FS|ES,
/* 229 */ RP|SH|LL|BS|FS|ES,
/* 230 */ RP|SH|BS|FS|ES,
/* 231 */ RP|SH|LH|BS|FS|ES,
/* 232 */ RP|SH|IX|BS|FS|ES,
/* 233 */ RP|SH|LS|LT|BS|FS|ES,
/* 234 */ RP|SH|BS|FS|ES,
/* 235 */ RP|SH|LP|BS|FS|ES,
/* 236 */ RP|SH|BS|FS|ES,
/* 237 */ RP|SH|LL|BS|FS|ES,
/* 238 */ RP|SH|BS|FS|ES,
/* 239 */ RP|SH|LH|BS|FS|ES,
/* 240 */ RP|SH|IX|BS|FS|ES,
/* 241 */ RP|SH|LS|LT|BS|FS|ES,
/* 242 */ RP|SH|BS|FS|ES,
/* 243 */ RP|SH|LP|BS|FS|ES,
/* 244 */ RP|SH|BS|FS|ES,
/* 245 */ RP|SH|LL|BS|FS|ES,
/* 246 */ RP|SH|BS|FS|ES,
/* 247 */ RP|SH|LH|BS|FS|ES,
/* 248 */ RP|SH|IX|BS|FS|ES,
/* 249 */ RP|SH|LS|LT|BS|FS|ES,
/* 250 */ RP|SH|BS|FS|ES,
/* 251 */ RP|SH|LP|BS|FS|ES,
/* 252 */ RP|SH|BS|FS|ES,
/* 253 */ RP|SH|LL|BS|FS|ES,
/* 254 */ RP|SH|BS|FS|ES,
/* 255 */ RP|SH|LH|BS|FS|ES,
/* 256 */ RP|SH|IY|ES,
/* 257 */ SH|LX|SS,
/* 258 */ ID,
/* 259 */ ID,
/* 260 */ ID,
/* 261 */ ID,
/* 262 */ ID,
/* 263 */ ID,
/* 264 */ ID,
/* 265 */ SS,
/* 266 */ ID,
/* 267 */ ID,
/* 268 */ ID,
/* 269 */ ID,
/* 270 */ ID,
/* 271 */ ID,
/* 272 */ ID,
/* 273 */ SS,
/* 274 */ ID,
/* 275 */ ID,
/* 276 */ ID,
/* 277 */ ID,
/* 278 */ ID,
/* 279 */ ID,
/* 280 */ ID,
/* 281 */ SS,
/* 282 */ ID,
/* 283 */ ID,
/* 284 */ ID,
/* 285 */ ID,
/* 286 */ ID,
/* 287 */ ID,
/* 288 */ ID,
/* 289 */ SS,
/* 290 */ ID,
/* 291 */ ID,
/* 292 */ ID,
/* 293 */ ID,
/* 294 */ ID,
/* 295 */ ID,
/* 296 */ ID,
/* 297 */ SS,
/* 298 */ ID,
/* 299 */ ID,
/* 300 */ ID,
/* 301 */ ID,
/* 302 */ ID,
/* 303 */ ID,
/* 304 */ ID,
/* 305 */ SS,
/* 306 */ ID,
/* 307 */ ID,
/* 308 */ ID,
/* 309 */ ID,
/* 310 */ ID,
/* 311 */ ID,
/* 312 */ ID,
/* 313 */ SS,
/* 314 */ ID,
/* 315 */ ID,
/* 316 */ ID,
/* 317 */ ID,
/* 318 */ ID,
/* 319 */ ID,
/* 320 */ ID,
/* 321 */ LS|LT|BS,
/* 322 */ BS,
/* 323 */ LP|BS,
/* 324 */ BS,
/* 325 */ LL|BS,
/* 326 */ BS,
/* 327 */ LH|BS,
/* 328 */ IX|BS,
/* 329 */ LS|LT|BS,
/* 330 */ BS,
/* 331 */ LP|BS,
/* 332 */ BS,
/* 333 */ LL|BS,
/* 334 */ BS,
/* 335 */ LH|BS,
/* 336 */ IX|BS,
/* 337 */ LS|LT,
/* 338 */ ID,
/* 339 */ LS|LT,
/* 340 */ ID
};

static enum event pre_render_scanline[341] = {
/* 000 */ ID,
/* 001 */ CV|LS|LT|BS|FS,
/* 002 */ CV|BS|FS,
/* 003 */ LP|BS|FS,
/* 004 */ BS|FS,
/* 005 */ LL|BS|FS,
/* 006 */ BS|FS,
/* 007 */ LH|BS|FS,
/* 008 */ IX|BS|FS,
/* 009 */ LS|LT|BS|FS,
/* 010 */ BS|FS,
/* 011 */ LP|BS|FS,
/* 012 */ BS|FS,
/* 013 */ LL|BS|FS,
/* 014 */ BS|FS,
/* 015 */ LH|BS|FS,
/* 016 */ IX|BS|FS,
/* 017 */ LS|LT|BS|FS,
/* 018 */ BS|FS,
/* 019 */ LP|BS|FS,
/* 020 */ BS|FS,
/* 021 */ LL|BS|FS,
/* 022 */ BS|FS,
/* 023 */ LH|BS|FS,
/* 024 */ IX|BS|FS,
/* 025 */ LS|LT|BS|FS,
/* 026 */ BS|FS,
/* 027 */ LP|BS|FS,
/* 028 */ BS|FS,
/* 029 */ LL|BS|FS,
/* 030 */ BS|FS,
/* 031 */ LH|BS|FS,
/* 032 */ IX|BS|FS,
/* 033 */ LS|LT|BS|FS,
/* 034 */ BS|FS,
/* 035 */ LP|BS|FS,
/* 036 */ BS|FS,
/* 037 */ LL|BS|FS,
/* 038 */ BS|FS,
/* 039 */ LH|BS|FS,
/* 040 */ IX|BS|FS,
/* 041 */ LS|LT|BS|FS,
/* 042 */ BS|FS,
/* 043 */ LP|BS|FS,
/* 044 */ BS|FS,
/* 045 */ LL|BS|FS,
/* 046 */ BS|FS,
/* 047 */ LH|BS|FS,
/* 048 */ IX|BS|FS,
/* 049 */ LS|LT|BS|FS,
/* 050 */ BS|FS,
/* 051 */ LP|BS|FS,
/* 052 */ BS|FS,
/* 053 */ LL|BS|FS,
/* 054 */ BS|FS,
/* 055 */ LH|BS|FS,
/* 056 */ IX|BS|FS,
/* 057 */ LS|LT|BS|FS,
/* 058 */ BS|FS,
/* 059 */ LP|BS|FS,
/* 060 */ BS|FS,
/* 061 */ LL|BS|FS,
/* 062 */ BS|FS,
/* 063 */ LH|BS|FS,
/* 064 */ IX|BS|FS,
/* 065 */ LS|LT|BS|FS,
/* 066 */ BS|FS,
/* 067 */ LP|BS|FS,
/* 068 */ BS|FS,
/* 069 */ LL|BS|FS,
/* 070 */ BS|FS,
/* 071 */ LH|BS|FS,
/* 072 */ IX|BS|FS,
/* 073 */ LS|LT|BS|FS,
/* 074 */ BS|FS,
/* 075 */ LP|BS|FS,
/* 076 */ BS|FS,
/* 077 */ LL|BS|FS,
/* 078 */ BS|FS,
/* 079 */ LH|BS|FS,
/* 080 */ IX|BS|FS,
/* 081 */ LS|LT|BS|FS,
/* 082 */ BS|FS,
/* 083 */ LP|BS|FS,
/* 084 */ BS|FS,
/* 085 */ LL|BS|FS,
/* 086 */ BS|FS,
/* 087 */ LH|BS|FS,
/* 088 */ IX|BS|FS,
/* 089 */ LS|LT|BS|FS,
/* 090 */ BS|FS,
/* 091 */ LP|BS|FS,
/* 092 */ BS|FS,
/* 093 */ LL|BS|FS,
/* 094 */ BS|FS,
/* 095 */ LH|BS|FS,
/* 096 */ IX|BS|FS,
/* 097 */ LS|LT|BS|FS,
/* 098 */ BS|FS,
/* 099 */ LP|BS|FS,
/* 100 */ BS|FS,
/* 101 */ LL|BS|FS,
/* 102 */ BS|FS,
/* 103 */ LH|BS|FS,
/* 104 */ IX|BS|FS,
/* 105 */ LS|LT|BS|FS,
/* 106 */ BS|FS,
/* 107 */ LP|BS|FS,
/* 108 */ BS|FS,
/* 109 */ LL|BS|FS,
/* 110 */ BS|FS,
/* 111 */ LH|BS|FS,
/* 112 */ IX|BS|FS,
/* 113 */ LS|LT|BS|FS,
/* 114 */ BS|FS,
/* 115 */ LP|BS|FS,
/* 116 */ BS|FS,
/* 117 */ LL|BS|FS,
/* 118 */ BS|FS,
/* 119 */ LH|BS|FS,
/* 120 */ IX|BS|FS,
/* 121 */ LS|LT|BS|FS,
/* 122 */ BS|FS,
/* 123 */ LP|BS|FS,
/* 124 */ BS|FS,
/* 125 */ LL|BS|FS,
/* 126 */ BS|FS,
/* 127 */ LH|BS|FS,
/* 128 */ IX|BS|FS,
/* 129 */ LS|LT|BS|FS,
/* 130 */ BS|FS,
/* 131 */ LP|BS|FS,
/* 132 */ BS|FS,
/* 133 */ LL|BS|FS,
/* 134 */ BS|FS,
/* 135 */ LH|BS|FS,
/* 136 */ IX|BS|FS,
/* 137 */ LS|LT|BS|FS,
/* 138 */ BS|FS,
/* 139 */ LP|BS|FS,
/* 140 */ BS|FS,
/* 141 */ LL|BS|FS,
/* 142 */ BS|FS,
/* 143 */ LH|BS|FS,
/* 144 */ IX|BS|FS,
/* 145 */ LS|LT|BS|FS,
/* 146 */ BS|FS,
/* 147 */ LP|BS|FS,
/* 148 */ BS|FS,
/* 149 */ LL|BS|FS,
/* 150 */ BS|FS,
/* 151 */ LH|BS|FS,
/* 152 */ IX|BS|FS,
/* 153 */ LS|LT|BS|FS,
/* 154 */ BS|FS,
/* 155 */ LP|BS|FS,
/* 156 */ BS|FS,
/* 157 */ LL|BS|FS,
/* 158 */ BS|FS,
/* 159 */ LH|BS|FS,
/* 160 */ IX|BS|FS,
/* 161 */ LS|LT|BS|FS,
/* 162 */ BS|FS,
/* 163 */ LP|BS|FS,
/* 164 */ BS|FS,
/* 165 */ LL|BS|FS,
/* 166 */ BS|FS,
/* 167 */ LH|BS|FS,
/* 168 */ IX|BS|FS,
/* 169 */ LS|LT|BS|FS,
/* 170 */ BS|FS,
/* 171 */ LP|BS|FS,
/* 172 */ BS|FS,
/* 173 */ LL|BS|FS,
/* 174 */ BS|FS,
/* 175 */ LH|BS|FS,
/* 176 */ IX|BS|FS,
/* 177 */ LS|LT|BS|FS,
/* 178 */ BS|FS,
/* 179 */ LP|BS|FS,
/* 180 */ BS|FS,
/* 181 */ LL|BS|FS,
/* 182 */ BS|FS,
/* 183 */ LH|BS|FS,
/* 184 */ IX|BS|FS,
/* 185 */ LS|LT|BS|FS,
/* 186 */ BS|FS,
/* 187 */ LP|BS|FS,
/* 188 */ BS|FS,
/* 189 */ LL|BS|FS,
/* 190 */ BS|FS,
/* 191 */ LH|BS|FS,
/* 192 */ IX|BS|FS,
/* 193 */ LS|LT|BS|FS,
/* 194 */ BS|FS,
/* 195 */ LP|BS|FS,
/* 196 */ BS|FS,
/* 197 */ LL|BS|FS,
/* 198 */ BS|FS,
/* 199 */ LH|BS|FS,
/* 200 */ IX|BS|FS,
/* 201 */ LS|LT|BS|FS,
/* 202 */ BS|FS,
/* 203 */ LP|BS|FS,
/* 204 */ BS|FS,
/* 205 */ LL|BS|FS,
/* 206 */ BS|FS,
/* 207 */ LH|BS|FS,
/* 208 */ IX|BS|FS,
/* 209 */ LS|LT|BS|FS,
/* 210 */ BS|FS,
/* 211 */ LP|BS|FS,
/* 212 */ BS|FS,
/* 213 */ LL|BS|FS,
/* 214 */ BS|FS,
/* 215 */ LH|BS|FS,
/* 216 */ IX|BS|FS,
/* 217 */ LS|LT|BS|FS,
/* 218 */ BS|FS,
/* 219 */ LP|BS|FS,
/* 220 */ BS|FS,
/* 221 */ LL|BS|FS,
/* 222 */ BS|FS,
/* 223 */ LH|BS|FS,
/* 224 */ IX|BS|FS,
/* 225 */ LS|LT|BS|FS,
/* 226 */ BS|FS,
/* 227 */ LP|BS|FS,
/* 228 */ BS|FS,
/* 229 */ LL|BS|FS,
/* 230 */ BS|FS,
/* 231 */ LH|BS|FS,
/* 232 */ IX|BS|FS,
/* 233 */ LS|LT|BS|FS,
/* 234 */ BS|FS,
/* 235 */ LP|BS|FS,
/* 236 */ BS|FS,
/* 237 */ LL|BS|FS,
/* 238 */ BS|FS,
/* 239 */ LH|BS|FS,
/* 240 */ IX|BS|FS,
/* 241 */ LS|LT|BS|FS,
/* 242 */ BS|FS,
/* 243 */ LP|BS|FS,
/* 244 */ BS|FS,
/* 245 */ LL|BS|FS,
/* 246 */ BS|FS,
/* 247 */ LH|BS|FS,
/* 248 */ IX|BS|FS,
/* 249 */ LS|LT|BS|FS,
/* 250 */ BS|FS,
/* 251 */ LP|BS|FS,
/* 252 */ BS|FS,
/* 253 */ LL|BS|FS,
/* 254 */ BS|FS,
/* 255 */ LH|BS|FS,
/* 256 */ IY,
/* 257 */ LX|SS,
/* 258 */ ID,
/* 259 */ ID,
/* 260 */ ID,
/* 261 */ ID,
/* 262 */ ID,
/* 263 */ ID,
/* 264 */ ID,
/* 265 */ SS,
/* 266 */ ID,
/* 267 */ ID,
/* 268 */ ID,
/* 269 */ ID,
/* 270 */ ID,
/* 271 */ ID,
/* 272 */ ID,
/* 273 */ SS,
/* 274 */ ID,
/* 275 */ ID,
/* 276 */ ID,
/* 277 */ ID,
/* 278 */ ID,
/* 279 */ ID,
/* 280 */ LY,
/* 281 */ LY|SS,
/* 282 */ LY,
/* 283 */ LY,
/* 284 */ LY,
/* 285 */ LY,
/* 286 */ LY,
/* 287 */ LY,
/* 288 */ LY,
/* 289 */ LY|SS,
/* 290 */ LY,
/* 291 */ LY,
/* 292 */ LY,
/* 293 */ LY,
/* 294 */ LY,
/* 295 */ LY,
/* 296 */ LY,
/* 297 */ LY|SS,
/* 298 */ LY,
/* 299 */ LY,
/* 300 */ LY,
/* 301 */ LY,
/* 302 */ LY,
/* 303 */ LY,
/* 304 */ LY,
/* 305 */ SS,
/* 306 */ ID,
/* 307 */ ID,
/* 308 */ ID,
/* 309 */ ID,
/* 310 */ ID,
/* 311 */ ID,
/* 312 */ ID,
/* 313 */ SS,
/* 314 */ ID,
/* 315 */ ID,
/* 316 */ ID,
/* 317 */ ID,
/* 318 */ ID,
/* 319 */ ID,
/* 320 */ ID,
/* 321 */ LS|LT|BS,
/* 322 */ BS,
/* 323 */ LP|BS,
/* 324 */ BS,
/* 325 */ LL|BS,
/* 326 */ BS,
/* 327 */ LH|BS,
/* 328 */ IX|BS,
/* 329 */ LS|LT|BS,
/* 330 */ BS,
/* 331 */ LP|BS,
/* 332 */ BS,
/* 333 */ LL|BS,
/* 334 */ BS,
/* 335 */ LH|BS,
/* 336 */ IX|BS,
/* 337 */ LS|LT,
/* 338 */ SC,
/* 339 */ LS|LT,
/* 340 */ ID
};

static enum event post_render_scanline[341] = {
/* 000 */ ID
};

static enum event special_post_render_scanline[341] = {
/* 000 */ ID,
/* 001 */ SV
};

void event_execute(struct ppu *ppu) {
	enum event events = ID;
	if (ppu->scanline <= 239) {
		events = visible_scanline[ppu->cycle];
	} else if (ppu->scanline == 240 || (ppu->scanline >= 242 && ppu->scanline <= 260)) {
		events = post_render_scanline[ppu->cycle];
	} else if (ppu->scanline == 241) {
		events = special_post_render_scanline[ppu->cycle];
	} else if (ppu->scanline == 261) {
		events = pre_render_scanline[ppu->cycle];
	}

	for (size_t i = 0; i < max_events; i++) {
		if ((events >> i) & 1) {
			event_map[i + 1](ppu);
		}
	}
}